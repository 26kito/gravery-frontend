<template>
    <div class="page">
        <div class="navbar navbar-large navbar-transparent">
            <div class="navbar-bg"></div>
            <div class="navbar-inner navbar-inner-centered-title">
                <div class="left">
                    <a class="link back">
                        <i class="icon icon-back"></i>
                        <span class="if-not-md">Framework7</span>
                    </a>
                </div>
                <!-- <div class="title sliding">Saat Ini</div> -->
                <div class="title-large">
                    <div class="title-large-text">Ongoing Pickup</div>
                </div>
            </div>
        </div>
        <div class="page-content ongoing-content-wrapper">
            <div class="ongoing-content display-none">
                <div class="block-title block-title-medium">Detail Pesanan</div>
                <div class="grid grid-cols" id="ongoing-list-order"></div>
                <div class="block-title block-title-medium">Detail Order</div>
                <div class="grid grid-cols" id="pickup-detail-orderitems"></div>
            </div>
            <div class="card">
                <div id="map" style="height: 400px"></div>
            </div>
        </div>
    </div>
</template>
<script>
    export default async function (props, ctx) {
        ctx.$on("pageInit", async () => {
            await showOngoing()

            /* const courierLat = localStorage.getItem('latitude')
            const courierLong = localStorage.getItem('longitude')
            const custLat = localStorage.getItem('custLat')
            const custLong = localStorage.getItem('custLong')

            let map = L.map('map').setView([courierLat, courierLong], 18);

            // Add OpenStreetMap tile layer
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            }).addTo(map);

            // Marker for the user's location
            let marker = L.marker([courierLat, courierLong]).addTo(map);
            marker.bindTooltip('Posisi kamu', { permanent: true }).openTooltip()
            let customerMarker = L.marker([custLat, custLong]).addTo(map);
            customerMarker.bindTooltip('Posisi customer', { permanent: true }).openTooltip()

            // Watch user's location and update the marker
            navigator.geolocation.watchPosition(function (position) {
                let lat = position.coords.latitude;
                let lon = position.coords.longitude;
                let accuracy = position.coords.accuracy;

                // Update the marker position
                marker.setLatLng([lat, lon]);

                // Center the map on the new position
                map.setView([lat, lon]);

                // Optionally, add a circle to show the accuracy of the location
                let circle = L.circle([lat, lon], {
                    radius: accuracy
                }).addTo(map);
            }, function (error) {
                console.error("Error watching position: ", error);
            }, {
                enableHighAccuracy: true,
                maximumAge: 0,
                timeout: 60000
            }); */
        })

        return $render
    }
</script>
